@model List<ReceiptViewModel>
<style>
    .modal-custom {
        max-width: 1000px; /* Adjust width as needed */
    }
</style>
<form asp-action="ExportCashSummary" asp-controller="ReceiptTransaction" asp-area="Staff" method="post">
    @if (Model != null)
    {
        @for (int i = 0; i < Model.Count; i++)
        {
            var items = Model[i];
            <input type="hidden" name="Results[@i].TestGroupDept" value="@items.TestGroupDept" />

            @foreach (var item in items.Receipts)
            {
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].ReceiptNo" value="@item.ReceiptNo" />
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].PayType" value="@item.PayType" />
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].PatientName" value="@item.PatientName" />
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].TotalAmount" value="@item.TotalAmount" />
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].DoctorName" value="@item.DoctorName" />
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].CreatedDate" value="@item.CreatedDate" />
                <!-- Add more hidden inputs as needed for other properties -->
                <!-- Dropdown Actions (assuming you're only capturing ReceiptNo for dropdown actions) -->
                <input type="hidden" name="Results[@i].Receipts[@items.Receipts.IndexOf(item)].ActionReceiptNo" value="@item.ReceiptNo" />
            }

            <!-- Total Amount -->
            <input type="hidden" name="Results[@i].ReceiptTotal" value="@items.ReceiptTotal" />
        }
    }

    <button type="submit"  class="btn btn-primary">Export to Excel</button>
</form>

<div class="row">
    <div class="col-md-12">
        <div class="table-responsive">
            <table class="table table-striped custom-table ">
                <thead>
                    <tr>
                        <th>Receipt No</th>
                        <th>PayType</th>
                        <th>PatientName</th>
                        <th> Amount</th>
                        <th>Doctor Name</th>
                        <th>Date</th>
                        <th>Receipt Type</th>
                        <th class="text-right">Action</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null)
                    {
                        @foreach(var items in Model)
                        {
                            <tr>
                                <td colspan="3" style="text-align:center;font-weight: bold;"><b>@items.TestGroupDept</b> </td>
                            </tr>
                            @foreach(var item in items.Receipts)
                            {
                                <tr>
                                    <td>@Html.DisplayFor(modelItem => item.ReceiptNo)  </td>
                                    <td>@Html.DisplayFor(modelItem => item.PayType)  </td>

                                    <td>@Html.DisplayFor(modelItem => item.PatientName)  </td>

                                    <td>@Html.DisplayFor(modelItem => item.TotalAmount)  </td>
                                    <td>@Html.DisplayFor(modelItem => item.DoctorName)  </td>

                                    <td>@Html.DisplayFor(modelItem => item.CreatedDate)  </td>

                                    <td><a class="btn btn-sm btn-primary custom-badge status-grey" href="salary-view.html">Generate Slip</a></td>
                                    <td class="text-right">
                                        <div class="dropdown dropdown-action">
                                            <a class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <button class="btnView dropdown-item" id="btnView" data-id="@item.ReceiptNo"><i class="fa fa-pencil m-r-5"></i> View</button>
                                                <a class="dropdown-item" href="#"><i class="fa fa-trash-o m-r-5"></i> Print</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            }
                            <tr>
                                <td colspan="3" style="text-align:center;font-weight: bold;"><b>--TOTAL AMOUNT--</b> </td>
                                <td style="font-weight: bold;">@items.ReceiptTotal</td>
                            </tr>
                            
                        }

                    }

                </tbody>
            </table>
        </div>
    </div>
</div>

